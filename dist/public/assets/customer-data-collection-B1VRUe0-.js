import{r as u,x as K,z as Z,a as q,j as e,H as C,C as l,c as H,d as Q,n as g,e as n,k as j,l as k,i as U,h as f,V as v,B as o,ac as D,ad as W,ae as M,Q as O}from"./index-Zh9LXilC.js";import{P as X}from"./progress-DOHd-Qjm.js";import{S as N,a as p,b as y,c as w,d as a}from"./select-gtWyGZLW.js";import{C as T}from"./customer-navigation-B4gGF7xv.js";import{u as Y}from"./use-live-tenant-permissions-pqtoXFLA.js";import"./index-mrnBHjv1.js";const _="030d3e01-32c4-4f95-8d54-98be948e8d4b";function re(){const[i,L]=u.useState("all"),[c,R]=u.useState("all"),[d,A]=u.useState("all"),b=K().tenantId||_,{t:J}=Z(),{permissions:P,tenantName:S,isLoading:z}=Y({tenantId:b,pollInterval:3e3}),t=P||{dashboard:!0,regulatoryUpdates:!0,legalCases:!0,knowledgeBase:!0,newsletters:!0,analytics:!1,reports:!1,dataCollection:!0,globalSources:!1,historicalData:!1,administration:!1,userManagement:!1,systemSettings:!1,auditLogs:!1,analyticsInsights:!1,advancedAnalytics:!1},{data:r,isLoading:I}=q({queryKey:["/api/data-collection",b],queryFn:async()=>{const s=await fetch("/api/data-collection");if(!s.ok)throw new Error("Failed to fetch collection data");return await s.json()},enabled:!!(t!=null&&t.dataCollection),refetchInterval:5e3});if(z)return e.jsx("div",{className:"flex h-screen bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(!(t!=null&&t.dataCollection))return e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(C,{})}),e.jsx(T,{permissions:t,tenantName:S||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 flex items-center justify-center",children:e.jsxs(l,{className:"max-w-md",children:[e.jsx(H,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),J("access.restricted")]})}),e.jsx(n,{children:e.jsx("p",{className:"text-muted-foreground",children:"Sie haben keine Berechtigung für den Zugriff auf Datensammlung. Kontaktieren Sie Ihren Administrator für weitere Informationen."})})]})})]});const E=(r==null?void 0:r.jobs)||[],x=(r==null?void 0:r.stats)||{totalJobs:0,activeJobs:0,successfulJobs:0,totalRecords:0},h=E.filter(s=>{const m=i==="all"||s.status===i,V=c==="all"||s.region===c,G=d==="all"||s.dataType===d;return m&&V&&G}),B=s=>{switch(s){case"running":return e.jsx(j,{className:"w-5 h-5 text-blue-500 animate-spin"});case"completed":return e.jsx(k,{className:"w-5 h-5 text-green-500"});case"failed":return e.jsx(v,{className:"w-5 h-5 text-red-500"});case"paused":return e.jsx(D,{className:"w-5 h-5 text-yellow-500"});case"scheduled":return e.jsx(O,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(j,{className:"w-5 h-5 text-gray-500"})}},F=s=>{const m={running:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",paused:"bg-yellow-100 text-yellow-800",scheduled:"bg-gray-100 text-gray-800"};return e.jsx(f,{className:m[s]||m.scheduled,children:s})};return e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(C,{})}),e.jsx(T,{permissions:t,tenantName:S||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Datensammlung"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Übersicht über laufende und geplante Datensammlung-Prozesse"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsx(l,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Gesamt Jobs"}),e.jsx("div",{className:"text-2xl font-bold",children:x.totalJobs})]}),e.jsx(g,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Aktive Jobs"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.activeJobs})]}),e.jsx(j,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Erfolgreiche Jobs"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.successfulJobs})]}),e.jsx(k,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Gesamt Datensätze"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.totalRecords.toLocaleString()})]}),e.jsx(U,{className:"h-8 w-8 text-purple-500"})]})})})]}),e.jsx(l,{className:"mb-6",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{children:e.jsxs(N,{value:i,onValueChange:L,children:[e.jsx(p,{children:e.jsx(y,{placeholder:"Status"})}),e.jsxs(w,{children:[e.jsx(a,{value:"all",children:"Alle Status"}),e.jsx(a,{value:"running",children:"Läuft"}),e.jsx(a,{value:"completed",children:"Abgeschlossen"}),e.jsx(a,{value:"failed",children:"Fehlgeschlagen"}),e.jsx(a,{value:"paused",children:"Pausiert"}),e.jsx(a,{value:"scheduled",children:"Geplant"})]})]})}),e.jsx("div",{children:e.jsxs(N,{value:c,onValueChange:R,children:[e.jsx(p,{children:e.jsx(y,{placeholder:"Region"})}),e.jsxs(w,{children:[e.jsx(a,{value:"all",children:"Alle Regionen"}),e.jsx(a,{value:"eu",children:"Europa"}),e.jsx(a,{value:"usa",children:"USA"}),e.jsx(a,{value:"asia",children:"Asien"})]})]})}),e.jsx("div",{children:e.jsxs(N,{value:d,onValueChange:A,children:[e.jsx(p,{children:e.jsx(y,{placeholder:"Datentyp"})}),e.jsxs(w,{children:[e.jsx(a,{value:"all",children:"Alle Typen"}),e.jsx(a,{value:"regulations",children:"Regulierungen"}),e.jsx(a,{value:"approvals",children:"Zulassungen"}),e.jsx(a,{value:"legal",children:"Rechtsprechung"}),e.jsx(a,{value:"news",children:"News"})]})]})})]})})}),I?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"})]},s))}):h&&h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx(l,{className:"hover:shadow-md transition-shadow",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[B(s.status),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.source})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[F(s.status),e.jsx(f,{variant:"outline",children:s.region}),e.jsx(f,{variant:"outline",children:s.dataType})]})]}),s.status==="running"&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("span",{children:["Fortschritt: ",s.recordsCollected.toLocaleString()," / ",s.totalRecords.toLocaleString()]}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx(X,{value:s.progress})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Start:"}),e.jsx("div",{className:"font-medium",children:new Date(s.startTime).toLocaleString("de-DE")})]}),s.endTime&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Ende:"}),e.jsx("div",{className:"font-medium",children:new Date(s.endTime).toLocaleString("de-DE")})]}),s.nextRun&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Nächster Lauf:"}),e.jsx("div",{className:"font-medium",children:new Date(s.nextRun).toLocaleString("de-DE")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Zeitplan:"}),e.jsx("div",{className:"font-medium",children:s.schedule})]})]}),(s.errors>0||s.warnings>0)&&e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm",children:[s.errors>0&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(v,{className:"w-4 h-4"}),s.errors," Fehler"]}),s.warnings>0&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[e.jsx(v,{className:"w-4 h-4"}),s.warnings," Warnungen"]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[s.status==="running"&&e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Pausieren"]}),s.status==="paused"&&e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Fortsetzen"]}),(s.status==="failed"||s.status==="completed")&&e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Wiederholen"]}),e.jsx(o,{variant:"outline",size:"sm",children:"Details anzeigen"})]})]})},s.id))}):e.jsx(l,{children:e.jsxs(n,{className:"text-center py-12",children:[e.jsx(g,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Datensammlung-Jobs verfügbar"}),e.jsx("p",{className:"text-gray-500",children:i!=="all"||c!=="all"||d!=="all"?"Ihre Filterkriterien ergaben keine Treffer.":"Aktuell sind keine Datensammlung-Jobs konfiguriert."})]})})]})})]})}export{re as default};
