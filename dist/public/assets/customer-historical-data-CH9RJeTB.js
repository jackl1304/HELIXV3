import{r as n,x as q,z as U,a as J,j as e,H as L,C as h,c as k,d as A,ag as f,e as o,_ as N,B as p,ah as Q,h as m,q as Y,g as Z,G as $,F as B,i as O}from"./index-BUxZYuNm.js";import{S as w,a as y,b,c as S,d as a}from"./select-Dxhz2xZH.js";import{C as z}from"./customer-navigation-B-CG8ezh.js";import{u as W}from"./use-live-tenant-permissions-CteBuFiC.js";import"./index-NLfbe9Ak.js";function ne(){const[r,I]=n.useState(""),[i,R]=n.useState("all"),[c,T]=n.useState("all"),[d,E]=n.useState("all"),[g,M]=n.useState(""),[u,P]=n.useState(""),C=q().tenantId,{t:F}=U(),{permissions:K,tenantName:D,isLoading:H}=W({tenantId:C,pollInterval:3e3}),l=K||{dashboard:!0,regulatoryUpdates:!0,legalCases:!0,knowledgeBase:!0,newsletters:!0,analytics:!1,reports:!1,dataCollection:!1,globalSources:!1,historicalData:!0,administration:!1,userManagement:!1,systemSettings:!1,auditLogs:!1,aiInsights:!1,advancedAnalytics:!1},{data:j,isLoading:V}=J({queryKey:["/api/historical-data",C,i,c,d],queryFn:async()=>{const s=new URLSearchParams({category:i,region:c,year:d,...g&&{startDate:g},...u&&{endDate:u}}),t=await fetch(`/api/historical-data?${s}`);if(!t.ok)throw new Error("Failed to fetch historical data");return await t.json()},enabled:!!(l!=null&&l.historicalData)});if(H)return e.jsx("div",{className:"flex h-screen bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(!(l!=null&&l.historicalData))return e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(L,{})}),e.jsx(z,{permissions:l,tenantName:D||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 flex items-center justify-center",children:e.jsxs(h,{className:"max-w-md",children:[e.jsx(k,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),F("access.restricted")]})}),e.jsx(o,{children:e.jsx("p",{className:"text-muted-foreground",children:"Sie haben keine Berechtigung für den Zugriff auf Historische Daten. Kontaktieren Sie Ihren Administrator für weitere Informationen."})})]})})]});const v=(j==null?void 0:j.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())||s.content.toLowerCase().includes(r.toLowerCase())))||[],_=s=>{if(!s)return"N/A";const t=["Bytes","KB","MB","GB"],x=Math.floor(Math.log(s)/Math.log(1024));return Math.round(s/Math.pow(1024,x)*100)/100+" "+t[x]},G=s=>{switch(s==null?void 0:s.toLowerCase()){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx(L,{})}),e.jsx(z,{permissions:l,tenantName:D||"Customer Portal"}),e.jsx("main",{className:"ml-64 flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Historische Daten"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Archivierte regulatorische Dokumente und historische Datenbestände"})]}),e.jsx(h,{className:"mb-6",children:e.jsxs(o,{className:"p-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(N,{placeholder:"Suche nach historischen Daten...",value:r,onChange:s=>I(s.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(w,{value:i,onValueChange:R,children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Kategorie"})}),e.jsxs(S,{children:[e.jsx(a,{value:"all",children:"Alle Kategorien"}),e.jsx(a,{value:"regulations",children:"Regulierungen"}),e.jsx(a,{value:"approvals",children:"Zulassungen"}),e.jsx(a,{value:"legal",children:"Rechtsprechung"}),e.jsx(a,{value:"standards",children:"Standards"})]})]})}),e.jsx("div",{children:e.jsxs(w,{value:c,onValueChange:T,children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Region"})}),e.jsxs(S,{children:[e.jsx(a,{value:"all",children:"Alle Regionen"}),e.jsx(a,{value:"eu",children:"Europa"}),e.jsx(a,{value:"usa",children:"USA"}),e.jsx(a,{value:"asia",children:"Asien"})]})]})}),e.jsx("div",{children:e.jsxs(w,{value:d,onValueChange:E,children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Jahr"})}),e.jsxs(S,{children:[e.jsx(a,{value:"all",children:"Alle Jahre"}),e.jsx(a,{value:"2024",children:"2024"}),e.jsx(a,{value:"2023",children:"2023"}),e.jsx(a,{value:"2022",children:"2022"}),e.jsx(a,{value:"2021",children:"2021"}),e.jsx(a,{value:"2020",children:"2020"})]})]})}),e.jsx("div",{children:e.jsxs(p,{variant:"outline",className:"w-full",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Erweitert"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mt-4",children:[e.jsx("div",{children:e.jsx(N,{type:"date",placeholder:"Von Datum",value:g,onChange:s=>M(s.target.value)})}),e.jsx("div",{children:e.jsx(N,{type:"date",placeholder:"Bis Datum",value:u,onChange:s=>P(s.target.value)})})]})]})}),V?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsxs("div",{className:"bg-white rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"})]},s))}):v&&v.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(s=>e.jsxs(h,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(A,{className:"text-lg font-semibold line-clamp-2",children:s.title}),e.jsx(m,{className:G(s.priority),children:s.priority})]}),e.jsx(Y,{className:"line-clamp-3",children:s.summary||s.content.substring(0,150)+"..."})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.archived_at).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:s.region})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:s.document_type})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Quelle: ",s.source]}),e.jsxs(m,{variant:"outline",children:["v",s.version]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Größe: ",_(s.file_size)]}),e.jsxs("span",{className:"text-gray-500",children:[s.download_count," Downloads"]})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.tags.slice(0,4).map((t,x)=>e.jsx(m,{variant:"outline",className:"text-xs",children:t},x)),s.tags.length>4&&e.jsxs(m,{variant:"outline",className:"text-xs",children:["+",s.tags.length-4," weitere"]})]})}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Anzeigen"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Download"]})]})]})]},s.id))}):e.jsx(h,{children:e.jsxs(o,{className:"text-center py-12",children:[e.jsx(f,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine historischen Daten verfügbar"}),e.jsx("p",{className:"text-gray-500",children:r||i!=="all"||c!=="all"||d!=="all"?"Ihre Suchkriterien ergaben keine Treffer.":"Aktuell sind keine historischen Daten verfügbar."})]})})]})})]})}export{ne as default};
