import{as as Z,r as g,a as J,b as z,j as e,K as w,n as D,b0 as E,O as k,B as l,i as Q,F as W,b1 as L,C as d,c as j,d as y,ac as V,ad as X,ae as Y,e as o,h as S,s as _,ay as R,l as I,aA as ee,aI as te,Q as G,A as se,b2 as ae}from"./index-BUxZYuNm.js";import{T as ie,a as ne,b as f,c as O}from"./tabs-Bg_j4-QG.js";import{P as re}from"./progress-C0uVNcle.js";function oe(){var F;const{toast:c}=Z(),[B,$]=g.useState("phase1"),[C,P]=g.useState(!1),[i,T]=g.useState(null),[u,h]=g.useState(!1),b=async()=>{P(!0);try{const t=await fetch("/api/admin/search-duplicates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=(await t.json()).data,r={totalRecords:a.totalRegulatory+a.totalLegal,duplicatesFound:a.duplicateRegulatory+a.duplicateLegal,duplicateGroups:[],qualityScore:a.qualityScore,overallDuplicatePercentage:a.overallDuplicatePercentage,timestamp:a.timestamp};T(r),c({title:"Duplikate-Suche abgeschlossen",description:t.message||`${r.duplicatesFound} Duplikate gefunden`})}catch(t){console.error("Duplikate-Suche fehlgeschlagen:",t),c({title:"Fehler bei der Duplikate-Suche",description:t.message||"Ein unbekannter Fehler ist aufgetreten.",variant:"destructive"})}finally{P(!1)}},K=async()=>{var t;h(!0);try{const s=await fetch("/api/admin/cleanup-duplicates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const a=await s.json();c({title:"Automatische Bereinigung abgeschlossen",description:`${((t=a.data)==null?void 0:t.duplicatesRemoved)||0} Duplikate entfernt`}),T(null),await b()}catch(s){console.error("Automatische Duplikat-Entfernung fehlgeschlagen:",s),c({title:"Fehler bei automatischer Bereinigung",description:s.message||"Ein unbekannter Fehler ist aufgetreten.",variant:"destructive"})}finally{h(!1)}},M=async()=>{var t;if(!((t=i==null?void 0:i.removalCandidates)!=null&&t.length)){c({title:"Keine Duplikate zum Löschen",description:"Führe zuerst eine Duplikate-Suche durch.",variant:"destructive"});return}h(!0);try{const a=i.removalCandidates;let r=0;for(let n=0;n<a.length;n+=100){const x=a.slice(n,n+100),N=await ee("/api/quality/remove-duplicates","POST",{candidateIds:x});r+=N.removedCount||0}c({title:"Duplikate erfolgreich gelöscht",description:`${r} Duplikate wurden entfernt.`}),await b()}catch(s){console.error("Duplikate-Löschung fehlgeschlagen:",s),c({title:"Fehler beim Löschen der Duplikate",description:s.message||"Ein unbekannter Fehler ist aufgetreten.",variant:"destructive"})}finally{h(!1)}},{data:v,isLoading:U}=J({queryKey:["/api/admin/development-phases"],queryFn:async()=>[{id:"phase1",name:"Phase 1: System-Grundlagen",description:"Grundlegende Systemarchitektur und Core-Funktionalitäten",status:"completed",progress:100,startDate:"2025-07-15T00:00:00Z",completedDate:"2025-07-31T00:00:00Z",estimatedDuration:"2 Wochen",tasks:[{id:"p1-t1",name:"Datenbank-Schema erstellen",description:"PostgreSQL Schema für Knowledge Base, Legal Cases und Regulatory Updates",status:"completed",category:"database",priority:"high"},{id:"p1-t2",name:"Backend API Grundgerüst",description:"Express.js Server mit TypeScript und Drizzle ORM",status:"completed",category:"backend",priority:"high"},{id:"p1-t3",name:"Frontend Basis-Setup",description:"React mit TypeScript und Tailwind CSS",status:"completed",category:"frontend",priority:"high"},{id:"p1-t4",name:"Authentication System",description:"OpenID Connect Integration",status:"completed",category:"backend",priority:"medium"}]},{id:"phase2",name:"Phase 2: Data Collection & AI",description:"Automatisierte Datensammlung und KI-gestützte Analyse",status:"completed",progress:95,startDate:"2025-07-31T00:00:00Z",completedDate:"2025-08-01T00:00:00Z",estimatedDuration:"1 Woche",tasks:[{id:"p2-t1",name:"Universal Knowledge Extractor",description:"13 internationale Datenquellen Integration",status:"completed",category:"backend",priority:"high"},{id:"p2-t2",name:"JAMA Network Integration",description:"Spezielle Integration für medizinische Fachartikel",status:"completed",category:"backend",priority:"high"},{id:"p2-t3",name:"Knowledge Base Frontend",description:"Benutzeroberfläche für Knowledge Articles",status:"completed",category:"frontend",priority:"medium"},{id:"p2-t4",name:"AI Content Analysis",description:"Automatische Kategorisierung und Bewertung",status:"in-progress",category:"backend",priority:"medium"}]},{id:"phase3",name:"Phase 3: Production & Optimization",description:"Production-Deployment und Performance-Optimierung",status:"in-progress",progress:75,startDate:"2025-08-01T00:00:00Z",estimatedDuration:"1 Woche",tasks:[{id:"p3-t1",name:"Production Deployment",description:"Production Deployment mit Custom Domain",status:"completed",category:"deployment",priority:"high"},{id:"p3-t2",name:"Performance Monitoring",description:"Winston Logging und Health Checks",status:"completed",category:"backend",priority:"high"},{id:"p3-t3",name:"Security Hardening",description:"Rate Limiting, Input Validation, HTTPS",status:"completed",category:"backend",priority:"high"},{id:"p3-t4",name:"Documentation Suite",description:"Umfassende System-Dokumentation",status:"completed",category:"backend",priority:"medium"},{id:"p3-t5",name:"Advanced Analytics",description:"Dashboard-Optimierung und Reporting",status:"in-progress",category:"frontend",priority:"medium"},{id:"p3-t6",name:"User Experience Polish",description:"UI/UX Verbesserungen und Mobile Optimierung",status:"pending",category:"frontend",priority:"low"}]}]}),m=z({mutationFn:async({phaseId:t,action:s})=>{try{const a=await fetch(`/api/admin/phases/${t}/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(a){throw console.error("Phase execution error:",a),a}},onSuccess:()=>{te.invalidateQueries({queryKey:["/api/admin/development-phases"]}),c({title:"Phase-Aktion erfolgreich",description:"Die Entwicklungsphase wurde aktualisiert."})},onError:t=>{c({title:"Fehler",description:t.message,variant:"destructive"})}}),p=z({mutationFn:async t=>{const a=await(await fetch(`/api/admin/download-documentation?format=${t}`)).blob(),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`helix-documentation.${t}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(r),document.body.removeChild(n)},onSuccess:()=>{c({title:"Download gestartet",description:"Die Dokumentation wird heruntergeladen."})}}),q=t=>{switch(t){case"completed":return e.jsx(I,{className:"h-4 w-4 text-green-500"});case"in-progress":return e.jsx(G,{className:"h-4 w-4 text-blue-500"});case"failed":return e.jsx(se,{className:"h-4 w-4 text-red-500"});default:return e.jsx(G,{className:"h-4 w-4 text-gray-400"})}},A=t=>{const s={completed:"default","in-progress":"secondary",pending:"outline",failed:"destructive"},a={completed:"Abgeschlossen","in-progress":"In Bearbeitung",pending:"Ausstehend",failed:"Fehlgeschlagen"};return e.jsx(S,{variant:s[t],children:a[t]})},H=t=>{switch(t){case"backend":return e.jsx(E,{className:"h-4 w-4"});case"frontend":return e.jsx(ae,{className:"h-4 w-4"});case"database":return e.jsx(D,{className:"h-4 w-4"});case"deployment":return e.jsx(L,{className:"h-4 w-4"});default:return e.jsx(w,{className:"h-4 w-4"})}};return U?e.jsx("div",{className:"p-6",children:"Lade Administration..."}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-gradient-to-r from-slate-600 via-gray-700 to-zinc-800 rounded-2xl shadow-lg",children:e.jsx(w,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"System Administration"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsxs("div",{className:"px-4 py-2 bg-slate-100 dark:bg-slate-900/30 text-slate-800 dark:text-slate-200 rounded-xl text-sm font-semibold flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),"Datenbank-Management"]}),e.jsxs("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200 rounded-xl text-sm font-semibold flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),"System-Status"]}),e.jsxs("div",{className:"px-4 py-2 bg-zinc-100 dark:bg-zinc-900/30 text-zinc-800 dark:text-zinc-200 rounded-xl text-sm font-semibold flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),"Security & Cleanup"]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Entwicklungsphasen und System-Management für Helix Platform mit Executive-Controls"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",onClick:()=>p.mutate("zip"),disabled:p.isPending,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Dokumentation (.zip)"]}),e.jsxs(l,{variant:"outline",onClick:()=>p.mutate("pdf"),disabled:p.isPending,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Dokumentation (.pdf)"]})]})]}),e.jsxs(ie,{value:B,onValueChange:$,className:"space-y-6",children:[e.jsxs(ne,{className:"grid w-full grid-cols-4",children:[e.jsxs(f,{value:"phase1",className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Phase 1"]}),e.jsxs(f,{value:"phase2",className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Phase 2"]}),e.jsxs(f,{value:"phase3",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Phase 3"]}),e.jsxs(f,{value:"duplicates",className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Duplikate-Management"]})]}),v==null?void 0:v.map(t=>e.jsxs(O,{value:t.id,className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(j,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"text-xl",children:t.name}),A(t.status)]}),e.jsxs("div",{className:"flex gap-2",children:[t.status==="in-progress"&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>m.mutate({phaseId:t.id,action:"pause"}),disabled:m.isPending,children:e.jsx(V,{className:"h-4 w-4"})}),t.status==="pending"&&e.jsxs(l,{size:"sm",onClick:()=>m.mutate({phaseId:t.id,action:"start"}),disabled:m.isPending,children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Starten"]}),(t.status==="failed"||t.status==="completed")&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>m.mutate({phaseId:t.id,action:"restart"}),disabled:m.isPending,children:e.jsx(Y,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.description})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Fortschritt"}),e.jsxs("span",{children:[t.progress,"%"]})]}),e.jsx(re,{value:t.progress,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Geschätzte Dauer:"}),e.jsx("br",{}),t.estimatedDuration]}),t.startDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Startdatum:"}),e.jsx("br",{}),new Date(t.startDate).toLocaleDateString("de-DE")]}),t.completedDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Abgeschlossen:"}),e.jsx("br",{}),new Date(t.completedDate).toLocaleDateString("de-DE")]})]})]})]}),e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs(y,{children:["Aufgaben (",t.tasks.length,")"]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-3",children:t.tasks.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[q(s.status),H(s.category),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"default":"outline",children:s.priority==="high"?"Hoch":s.priority==="medium"?"Mittel":"Niedrig"}),A(s.status)]})]},s.id))})})]})]},t.id)),e.jsx(O,{value:"duplicates",className:"space-y-6",children:e.jsxs(d,{children:[e.jsxs(j,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Duplikate-Management"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Suche und verwalte doppelte Einträge in der Datenbank"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(l,{onClick:b,disabled:C,className:"flex items-center gap-2",children:[C?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(_,{className:"h-4 w-4"}),"Duplikate suchen"]}),e.jsxs(l,{onClick:K,disabled:u,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white",children:[u?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(R,{className:"h-4 w-4"}),"Automatisch bereinigen"]}),i&&i.duplicatesFound>0&&e.jsxs(l,{onClick:M,disabled:u,className:"flex items-center gap-2 bg-[#d95d2c] hover:bg-[#b8441f] text-white",children:[u?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(R,{className:"h-4 w-4"}),"Duplikate löschen (",i.duplicatesFound,")"]})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(d,{children:e.jsxs(o,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.totalRecords}),e.jsx("div",{className:"text-sm text-gray-600",children:"Gesamte Einträge"})]})}),e.jsx(d,{children:e.jsxs(o,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.duplicatesFound}),e.jsx("div",{className:"text-sm text-gray-600",children:"Duplikate gefunden"})]})}),e.jsx(d,{children:e.jsxs(o,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((F=i.duplicateGroups)==null?void 0:F.length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Duplikate-Gruppen"})]})})]}),i.duplicateGroups&&i.duplicateGroups.length>0&&e.jsxs(d,{children:[e.jsx(j,{children:e.jsx(y,{children:"Gefundene Duplikate-Gruppen"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[i.duplicateGroups.slice(0,10).map((t,s)=>{var a,r,n;return e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"font-medium",children:["Gruppe ",s+1]}),e.jsxs(S,{variant:"outline",children:[((a=t.records)==null?void 0:a.length)||0," Einträge"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[(r=t.records)==null?void 0:r.slice(0,3).map((x,N)=>e.jsxs("div",{className:"truncate",children:["• ",x.title||x.id]},N)),((n=t.records)==null?void 0:n.length)>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["... und ",t.records.length-3," weitere"]})]}),e.jsxs("div",{className:"mt-2 text-xs",children:["Ähnlichkeit: ",((t.confidence||0)*100).toFixed(1),"%"]})]},s)}),i.duplicateGroups.length>10&&e.jsxs("div",{className:"text-center text-sm text-gray-500 p-2",children:["... und ",i.duplicateGroups.length-10," weitere Gruppen"]})]})})]})]}),i&&i.duplicatesFound===0&&e.jsx(d,{children:e.jsxs(o,{className:"p-6 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Keine Duplikate gefunden"}),e.jsx("p",{className:"text-gray-600",children:"Die Datenbank ist bereits bereinigt."})]})})]})]})})]})]})}export{oe as default};
