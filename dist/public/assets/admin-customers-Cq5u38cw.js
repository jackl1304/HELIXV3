import{r as g,j as e,aH as be,al as fe,a as $,b as Z,B as S,av as H,a6 as D,a7 as j,h as P,L as A,C as v,e as b,l as _,D as Ne,T as ye,s as we,_ as T,c as Se,d as ke,p as Ee,aI as F,aB as k,aA as B,o as Ce,U as Te,g as De,w as Pe,E as Ae,ay as W,V as Fe,Q as Be,k as ze,I as Me}from"./index-Zh9LXilC.js";import{S as z,a as M,b as I,c as K,d}from"./select-gtWyGZLW.js";import{D as L,a as Ie,b as O,c as R,d as q,e as V}from"./dialog-CyhKwo7K.js";import{S as G}from"./switch-BPOziYjt.js";import{u as Ke,a as Ue,F as Le,b as f,c as N,d as y,e as w,f as E,g as J,o as Oe,h as X,n as Y,s as ee,i as se}from"./types-C_wPavWe.js";import"./index-mrnBHjv1.js";var Re=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],qe=Re.reduce((n,r)=>{const t=be(`Primitive.${r}`),l=g.forwardRef((o,a)=>{const{asChild:i,...x}=o,u=i?t:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...x,ref:a})});return l.displayName=`Primitive.${r}`,{...n,[r]:l}},{}),Ve="Separator",ae="horizontal",Ge=["horizontal","vertical"],ne=g.forwardRef((n,r)=>{const{decorative:t,orientation:l=ae,...o}=n,a=Ze(l)?l:ae,x=t?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return e.jsx(qe.div,{"data-orientation":a,...x,...o,ref:r})});ne.displayName=Ve;function Ze(n){return Ge.includes(n)}var te=ne;const ie=g.forwardRef(({className:n,orientation:r="horizontal",decorative:t=!0,...l},o)=>e.jsx(te,{ref:o,decorative:t,orientation:r,className:fe("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",n),...l}));ie.displayName=te.displayName;function ss(){const[n,r]=g.useState(""),[t,l]=g.useState("all"),[o,a]=g.useState("all"),[i,x]=g.useState(!1),[u,re]=g.useState(null),[le,U]=g.useState(!1),[c,ce]=g.useState(null),[de,Q]=g.useState(!1),oe=s=>{re(s),U(!0)},xe=s=>{ce(s),Q(!0)},me=async s=>{if(confirm("Sind Sie sicher, dass Sie diesen Tenant lÃ¶schen mÃ¶chten?"))try{await B(`/api/admin/tenants/${s}`,"DELETE"),F.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Tenant gelÃ¶scht",description:"Der Tenant wurde erfolgreich gelÃ¶scht."})}catch{k({title:"Fehler",description:"Fehler beim LÃ¶schen des Tenants.",variant:"destructive"})}},{data:ue=[],isLoading:he}=$({queryKey:["/api/admin/tenants"]}),{data:C}=$({queryKey:["/api/admin/stats"],queryFn:async()=>({totalTenants:3,activeTenants:2,trialTenants:1,totalRevenue:3398,avgRevenuePerTenant:1132.67,planDistribution:{starter:1,professional:1,enterprise:1},growthRate:15.4,churnRate:2.1})});Z({mutationFn:async s=>{var p;const h={name:s.companyName,slug:((p=s.companyName)==null?void 0:p.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""))||"",industry:s.industry||"Medical Technology",subscriptionPlan:s.subscriptionPlan||"professional",subscriptionStatus:"trial",billingEmail:s.contactEmail,contactName:s.contactName,contactEmail:s.contactEmail,maxUsers:s.subscriptionPlan==="starter"?5:s.subscriptionPlan==="professional"?25:999999,maxDataSources:10,apiAccessEnabled:s.subscriptionPlan!=="starter"};return await B("/api/admin/tenants","POST",h)},onSuccess:()=>{F.invalidateQueries({queryKey:["/api/admin/tenants"]}),x(!1),k({title:"Tenant erstellt",description:"Der neue Tenant wurde erfolgreich erstellt."})}});const m=ue.filter(s=>{const h=s.name.toLowerCase().includes(n.toLowerCase())||(s.contactEmail||s.billingEmail).toLowerCase().includes(n.toLowerCase()),p=t==="all"||s.subscriptionStatus===t,ve=o==="all"||s.subscriptionPlan===o;return h&&p&&ve}),ge=({status:s})=>{const h={active:"bg-green-100 text-green-800",trial:"bg-blue-100 text-blue-800",suspended:"bg-red-100 text-red-800",canceled:"bg-gray-100 text-gray-800"},p={active:e.jsx(_,{className:"w-3 h-3 mr-1"}),trial:e.jsx(Be,{className:"w-3 h-3 mr-1"}),suspended:e.jsx(Fe,{className:"w-3 h-3 mr-1"}),canceled:e.jsx(W,{className:"w-3 h-3 mr-1"})};return e.jsxs(P,{className:h[s],children:[p[s],s.charAt(0).toUpperCase()+s.slice(1)]})},je=({plan:s})=>{const h={starter:"bg-blue-100 text-blue-800",professional:"bg-purple-100 text-purple-800",enterprise:"bg-orange-100 text-orange-800"},p={starter:e.jsx(D,{className:"w-3 h-3 mr-1"}),professional:e.jsx(Me,{className:"w-3 h-3 mr-1"}),enterprise:e.jsx(ze,{className:"w-3 h-3 mr-1"})};return e.jsxs(P,{className:h[s],children:[p[s],s.charAt(0).toUpperCase()+s.slice(1)]})},pe=({customer:s})=>e.jsx(v,{className:"mb-4 hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 via-purple-600 to-cyan-700 rounded-xl text-white font-bold text-lg",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{status:s.subscriptionStatus}),e.jsx(je,{plan:s.subscriptionPlan})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),s.billingEmail||s.contactEmail||"Keine E-Mail"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),s.maxUsers||0," Max. Benutzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),"Erstellt: ",new Date(s.createdAt).toLocaleDateString("de-DE")]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[s.subscriptionPlan==="enterprise"?"â‚¬2,499":s.subscriptionPlan==="professional"?"â‚¬899":"â‚¬199",e.jsx("span",{className:"text-sm text-muted-foreground",children:"/Monat"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:[s.maxDataSources," Datenquellen / ",s.maxUsers," Max. Benutzer"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>xe(s),title:"Tenant anzeigen",children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>oe(s),title:"Tenant bearbeiten",children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>me(s.id),title:"Tenant lÃ¶schen",children:e.jsx(W,{className:"w-4 h-4"})})]})]})]}),e.jsx(ie,{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.maxUsers}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Max. Benutzer"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.maxDataSources}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Datenquellen"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.apiAccessEnabled?"Ja":"Nein"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"API-Zugang"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:s.subscriptionStatus==="trial"?"Test":"Aktiv"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Status"})]})]})]})});return e.jsxs("div",{className:"container mx-auto p-6 space-y-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Kunden-Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Verwalten Sie Ihre SaaS-Kunden und deren Subscriptions"})]}),e.jsxs(L,{open:i,onOpenChange:x,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(S,{children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Neuen Kunden hinzufÃ¼gen"]})}),e.jsxs(O,{className:"max-w-2xl",children:[e.jsxs(R,{children:[e.jsx(q,{children:"Neuen Tenant erstellen"}),e.jsx(V,{children:"Erstellen Sie einen neuen Kunden-Tenant mit Subscription"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"w-16 h-16 mx-auto mb-4 text-blue-500"}),e.jsx("p",{className:"text-muted-foreground",children:"Tenant-Erstellung Ã¼ber das vollstÃ¤ndige Onboarding-System"}),e.jsx(S,{className:"mt-4",onClick:()=>window.open("/tenant-onboarding","_blank"),children:"Onboarding-Prozess starten"})]})]})]}),e.jsx(L,{open:de,onOpenChange:Q,children:e.jsxs(O,{className:"max-w-4xl",children:[e.jsxs(R,{children:[e.jsxs(q,{children:["Tenant Details - ",c==null?void 0:c.name]}),e.jsx(V,{children:"VollstÃ¤ndige Informationen zum Tenant"})]}),c&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Firma"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.name})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Slug"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.slug})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"E-Mail"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.billingEmail})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Subscription Plan"}),e.jsx(P,{variant:c.subscriptionPlan==="enterprise"?"destructive":"default",children:c.subscriptionPlan})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Status"}),e.jsx(P,{variant:c.subscriptionStatus==="active"?"default":"secondary",children:c.subscriptionStatus})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Max. Benutzer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.maxUsers})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Max. Datenquellen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.maxDataSources})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"API-Zugang"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.apiAccessEnabled?"Aktiviert":"Deaktiviert"})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Erstellt am"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(c.createdAt).toLocaleDateString("de-DE")})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-sm font-medium",children:"Trial endet am"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.trialEndsAt?new Date(c.trialEndsAt).toLocaleDateString("de-DE"):"Kein Trial"})]})]})]})]})}),e.jsx(L,{open:le,onOpenChange:U,children:e.jsxs(O,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsxs(q,{children:["Tenant bearbeiten - ",u==null?void 0:u.name]}),e.jsx(V,{children:"Tenant-Einstellungen Ã¤ndern"})]}),u&&e.jsx($e,{tenant:u,onClose:()=>U(!1)})]})})]}),C&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(A,{href:"/admin-customers",children:e.jsx(v,{className:"cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Gesamt Tenants"}),e.jsx("div",{className:"text-2xl font-bold",children:C.totalTenants})]}),e.jsx(D,{className:"h-8 w-8 text-blue-500"})]})})})}),e.jsx(A,{href:"/admin-customers",children:e.jsx(v,{className:"cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Aktive Kunden"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:C.activeTenants})]}),e.jsx(_,{className:"h-8 w-8 text-green-500"})]})})})}),e.jsx(A,{href:"/analytics",children:e.jsx(v,{className:"cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Monatsumsatz"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["â‚¬",C.totalRevenue.toLocaleString()]})]}),e.jsx(Ne,{className:"h-8 w-8 text-purple-500"})]})})})}),e.jsx(A,{href:"/analytics",children:e.jsx(v,{className:"cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Wachstumsrate"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["+",C.growthRate,"%"]})]}),e.jsx(ye,{className:"h-8 w-8 text-orange-500"})]})})})})]}),e.jsx(v,{children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Suche nach Firmenname oder E-Mail...",value:n,onChange:s=>r(s.target.value),className:"pl-10"})]})}),e.jsxs(z,{value:t,onValueChange:l,children:[e.jsx(M,{className:"w-40",children:e.jsx(I,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"Alle Status"}),e.jsx(d,{value:"active",children:"Aktiv"}),e.jsx(d,{value:"trial",children:"Trial"}),e.jsx(d,{value:"suspended",children:"Gesperrt"}),e.jsx(d,{value:"canceled",children:"GekÃ¼ndigt"})]})]}),e.jsxs(z,{value:o,onValueChange:a,children:[e.jsx(M,{className:"w-40",children:e.jsx(I,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"Alle PlÃ¤ne"}),e.jsx(d,{value:"starter",children:"Starter"}),e.jsx(d,{value:"professional",children:"Professional"}),e.jsx(d,{value:"enterprise",children:"Enterprise"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:he?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Lade Kunden..."})]}):(m==null?void 0:m.length)===0?e.jsx(v,{children:e.jsxs(b,{className:"p-12 text-center",children:[e.jsx(D,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Kunden gefunden"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:n||t!=="all"||o!=="all"?"Ihre Suchkriterien ergaben keine Treffer.":"Sie haben noch keine Kunden hinzugefÃ¼gt."}),!n&&t==="all"&&o==="all"&&e.jsxs(S,{onClick:()=>x(!0),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Ersten Kunden hinzufÃ¼gen"]})]})}):m==null?void 0:m.map(s=>e.jsx(pe,{customer:s},s.id))}),m&&m.length>0&&e.jsxs(v,{children:[e.jsx(Se,{children:e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"Zusammenfassung (",m.length," Kunden)"]})}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["â‚¬",m.length*1200]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gesamt-Umsatz/Monat"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.reduce((s,h)=>s+h.maxUsers,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gesamt-Benutzer"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.reduce((s,h)=>s+h.maxDataSources,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Datenquellen"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.filter(s=>s.subscriptionStatus==="active").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"})]})]})})]})]})}const Qe=Oe({name:ee().min(1,"Name ist erforderlich"),subscriptionPlan:se(["starter","professional","enterprise"]),subscriptionStatus:se(["trial","active","cancelled","suspended"]),billingEmail:ee().email("GÃ¼ltige E-Mail erforderlich"),maxUsers:Y().min(1),maxDataSources:Y().min(1),apiAccessEnabled:X(),customBrandingEnabled:X()});function $e({tenant:n,onClose:r}){const t=Ke({resolver:Ue(Qe),defaultValues:{name:n.name,subscriptionPlan:n.subscriptionPlan,subscriptionStatus:n.subscriptionStatus,billingEmail:n.billingEmail,maxUsers:n.maxUsers,maxDataSources:n.maxDataSources,apiAccessEnabled:n.apiAccessEnabled,customBrandingEnabled:n.customBrandingEnabled||!1}}),l=Z({mutationFn:async a=>await B(`/api/admin/tenants/${n.id}`,"PUT",a),onSuccess:()=>{F.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Tenant aktualisiert",description:"Die Tenant-Einstellungen wurden erfolgreich gespeichert."}),r()},onError:a=>{k({title:"Fehler",description:a.message||"Fehler beim Speichern der Ã„nderungen.",variant:"destructive"})}}),o=a=>{l.mutate(a)};return e.jsx(Le,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(o),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:t.control,name:"name",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Firmenname"}),e.jsx(w,{children:e.jsx(T,{...a})}),e.jsx(E,{})]})}),e.jsx(f,{control:t.control,name:"billingEmail",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Billing E-Mail"}),e.jsx(w,{children:e.jsx(T,{...a,type:"email"})}),e.jsx(E,{})]})}),e.jsx(f,{control:t.control,name:"subscriptionPlan",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Subscription Plan"}),e.jsxs(z,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(w,{children:e.jsx(M,{children:e.jsx(I,{})})}),e.jsxs(K,{children:[e.jsx(d,{value:"starter",children:"Starter"}),e.jsx(d,{value:"professional",children:"Professional"}),e.jsx(d,{value:"enterprise",children:"Enterprise"})]})]}),e.jsx(E,{})]})}),e.jsx(f,{control:t.control,name:"subscriptionStatus",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Status"}),e.jsxs(z,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(w,{children:e.jsx(M,{children:e.jsx(I,{})})}),e.jsxs(K,{children:[e.jsx(d,{value:"trial",children:"Trial"}),e.jsx(d,{value:"active",children:"Aktiv"}),e.jsx(d,{value:"cancelled",children:"GekÃ¼ndigt"}),e.jsx(d,{value:"suspended",children:"Gesperrt"})]})]}),e.jsx(E,{})]})}),e.jsx(f,{control:t.control,name:"maxUsers",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Max. Benutzer"}),e.jsx(w,{children:e.jsx(T,{...a,type:"number",onChange:i=>a.onChange(parseInt(i.target.value))})}),e.jsx(E,{})]})}),e.jsx(f,{control:t.control,name:"maxDataSources",render:({field:a})=>e.jsxs(N,{children:[e.jsx(y,{children:"Max. Datenquellen"}),e.jsx(w,{children:e.jsx(T,{...a,type:"number",onChange:i=>a.onChange(parseInt(i.target.value))})}),e.jsx(E,{})]})})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx(f,{control:t.control,name:"apiAccessEnabled",render:({field:a})=>e.jsxs(N,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(y,{children:"API-Zugang"}),e.jsx(J,{children:"Erlaubt Zugang zu API-Endpunkten"})]}),e.jsx(w,{children:e.jsx(G,{checked:a.value,onCheckedChange:a.onChange})})]})}),e.jsx(f,{control:t.control,name:"customBrandingEnabled",render:({field:a})=>e.jsxs(N,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(y,{children:"Custom Branding"}),e.jsx(J,{children:"Erlaubt eigenes Branding"})]}),e.jsx(w,{children:e.jsx(G,{checked:a.value,onCheckedChange:a.onChange})})]})})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Kundenberechtigung verwalten"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bestimmen Sie, welche Bereiche der Kunde in seinem Dashboard sehen und verwenden darf"}),e.jsx("div",{className:"max-h-80 overflow-y-auto border rounded-lg p-4 bg-gray-50 dark:bg-gray-900",children:e.jsx(He,{tenant:n})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:r,children:"Abbrechen"}),e.jsx(S,{type:"submit",disabled:l.isPending,children:l.isPending?"Speichere...":"Speichern"})]})]})})}function He({tenant:n}){const[r,t]=g.useState(()=>n.customerPermissions||{dashboard:!0,regulatoryUpdates:!0,legalCases:!0,knowledgeBase:!0,newsletters:!0,analytics:!1,reports:!1,dataCollection:!1,globalSources:!1,historicalData:!1,administration:!1,userManagement:!1,systemSettings:!1,auditLogs:!1,aiInsights:!1,advancedAnalytics:!1}),l=Z({mutationFn:async i=>await B(`/api/admin/tenants/${n.id}/permissions`,"PUT",{customerPermissions:i}),onSuccess:()=>{F.invalidateQueries({queryKey:["/api/admin/tenants"]}),k({title:"Berechtigungen aktualisiert",description:"Die Kundenberechtigung wurden erfolgreich gespeichert."})},onError:i=>{k({title:"Fehler",description:i.message||"Fehler beim Speichern der Berechtigungen.",variant:"destructive"})}}),o=(i,x)=>{const u={...r,[i]:x};t(u),l.mutate(u)},a=[{title:"Basis-Zugriff",description:"Grundlegende Bereiche fÃ¼r alle Kunden",permissions:[{key:"dashboard",label:"Dashboard",description:"HauptÃ¼bersicht und Statistiken"},{key:"regulatoryUpdates",label:"Regulatory Updates",description:"Regulatorische Ã„nderungen und Updates"},{key:"legalCases",label:"Rechtsprechung",description:"Gerichtsentscheidungen und PrÃ¤zedenzfÃ¤lle"},{key:"knowledgeBase",label:"Wissensdatenbank",description:"Artikel und Dokumentation"},{key:"newsletters",label:"Newsletter",description:"Newsletter-Verwaltung und -Abonnements"}]},{title:"Erweiterte Features",description:"ZusÃ¤tzliche Funktionen je nach Subscription",permissions:[{key:"analytics",label:"Analytics",description:"Datenanalyse und Berichte"},{key:"reports",label:"Reports",description:"Detaillierte Berichte generieren"},{key:"aiInsights",label:"Insights",description:"Datengetriebene Analysen und Erkenntnisse"},{key:"advancedAnalytics",label:"Erweiterte Analytics",description:"Fortgeschrittene Analysefunktionen"}]},{title:"Daten-Management",description:"Datenquellen und -verwaltung",permissions:[{key:"globalSources",label:"Globale Quellen",description:"Zugang zu allen Datenquellen"},{key:"dataCollection",label:"Datensammlung",description:"Eigene Daten sammeln und verwalten"},{key:"historicalData",label:"Historische Daten",description:"Zugang zu historischen DatensÃ¤tzen"}]},{title:"Administrative Bereiche",description:"Nur fÃ¼r besondere FÃ¤lle freigeben",permissions:[{key:"systemSettings",label:"Systemeinstellungen",description:"Zugang zu Systemkonfiguration"},{key:"userManagement",label:"Benutzerverwaltung",description:"Benutzer innerhalb des Tenants verwalten"},{key:"administration",label:"Administration",description:"Administrative Funktionen"},{key:"auditLogs",label:"Audit Logs",description:"Zugang zu System-Audit-Protokollen"}]}];return e.jsxs("div",{className:"space-y-4",children:[a.map(i=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"pb-2 border-b",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:i.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.description})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2",children:i.permissions.map(x=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-2 hover:bg-white dark:hover:bg-gray-800 bg-gray-50 dark:bg-gray-900 transition-colors",children:[e.jsxs("div",{className:"space-y-0 flex-1 pr-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:x.label}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:x.description})]}),e.jsx(G,{checked:r[x.key],onCheckedChange:u=>o(x.key,u),disabled:l.isPending,className:"flex-shrink-0"})]},x.key))})]},i.title)),l.isPending&&e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2",children:"ðŸ’¾ Speichere Ã„nderungen..."})]})}export{ss as default};
