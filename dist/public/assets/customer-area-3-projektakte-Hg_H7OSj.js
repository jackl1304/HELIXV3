import{ai as P,as as S,u as A,r as m,a as F,b as f,j as e,B as i,aC as K,O as L,C as l,c as r,d as c,e as o,F as O,bs as R,A as b,w as N,bt as z,f as B,bu as M,E as v,ag as w,h as k,i as y,av as V,q as _}from"./index-Zh9LXilC.js";import{T as q,a as Q,b as $,c as G}from"./tabs-DIpelL6C.js";const u=[{id:"charta",name:"Projektauftrag (Charta)",icon:O,color:"blue",section:"1. Projektinitialisierung"},{id:"requirements",name:"Anforderungen (Lastenheft)",icon:R,color:"purple",section:"2. Anforderungsmanagement"},{id:"risks",name:"Risikoanalyse (ISO 14971)",icon:b,color:"red",section:"3. Risikomanagement"},{id:"design_review",name:"Design-Review Protokoll",icon:N,color:"green",section:"4. Design & Entwicklung"},{id:"test_plan",name:"Testplan",icon:z,color:"orange",section:"5. Verifizierung & Validierung"},{id:"test_protocol",name:"Testprotokoll",icon:B,color:"orange",section:"5. Verifizierung & Validierung"},{id:"usability",name:"Usability-Test Bericht",icon:N,color:"cyan",section:"6. Gebrauchstauglichkeit"},{id:"conformity",name:"Konformitätserklärung (DOC)",icon:M,color:"indigo",section:"7. Technische Dokumentation"},{id:"changes",name:"Änderungsanträge",icon:v,color:"yellow",section:"8. Änderungsmanagement"},{id:"ncr",name:"Abweichungsberichte (NCR)",icon:b,color:"pink",section:"9. Qualitätsmanagement"},{id:"closure",name:"Projektabschlussbericht",icon:w,color:"slate",section:"10. Projektabschluss"}];function W(){const[,C]=P(),{toast:h}=S(),x=A(),[I,g]=m.useState(null),[U,Z]=m.useState("all"),[T,D]=m.useState("1. Projektinitialisierung"),{data:a=[],isLoading:J}=F({queryKey:["/api/projektakte-documents"]}),j=a.length>0?Math.round(a.filter(s=>s.status==="completed").length/a.length*100):0,d={draft:a.filter(s=>s.status==="draft").length,in_progress:a.filter(s=>s.status==="in_progress").length,completed:a.filter(s=>s.status==="completed").length},p=f({mutationFn:async s=>{const t=await fetch("/api/projektakte/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentType:s}),credentials:"include"});if(!t.ok)throw new Error("Failed to create document");return t.json()},onSuccess:s=>{x.invalidateQueries({queryKey:["/api/projektakte-documents"]}),h({title:"✅ Dokument erstellt",description:"Neues Projektakte-Dokument wurde erstellt"}),g(s.id)}});return f({mutationFn:async s=>{const t=await fetch(`/api/projektakte/${s}`,{method:"DELETE",credentials:"include"});if(!t.ok)throw new Error("Failed to delete document");return t.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/projektakte-documents"]}),h({title:"✅ Dokument gelöscht"})}}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>C("/customer-area-3/projects"),className:"gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Zurück"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(L,{className:"h-8 w-8 text-blue-600"}),"PROJEKTAKTE (MDR 2017/745)"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Vollständige Medizintechnik-Dokumentation nach regulatorischen Standards"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsx(r,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"Gesamtfortschritt"})}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[j,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-3",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${j}%`}})})]})]}),[{label:"Entwurf",value:d.draft,color:"yellow"},{label:"In Bearbeitung",value:d.in_progress,color:"orange"},{label:"Fertiggestellt",value:d.completed,color:"green"}].map(s=>e.jsxs(l,{children:[e.jsx(r,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:s.label})}),e.jsx(o,{children:e.jsx("div",{className:`text-3xl font-bold text-${s.color}-600`,children:s.value})})]},s.label))]}),e.jsxs(q,{value:T,onValueChange:D,className:"space-y-6",children:[e.jsx(Q,{className:"grid w-full grid-cols-5 gap-2 h-auto",children:[...new Set(u.map(s=>s.section))].map(s=>e.jsx($,{value:s,className:"text-xs cursor-pointer hover:opacity-75 transition-opacity",children:s.split(". ")[0]},s))}),[...new Set(u.map(s=>s.section))].map(s=>e.jsxs(G,{value:s,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mt-4",children:s}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.filter(t=>t.section===s).map(t=>{const n=a.find(E=>E.documentType===t.id);return e.jsxs(l,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t.icon,{className:`h-5 w-5 text-${t.color}-600`}),e.jsx(c,{className:"text-sm",children:t.name})]}),n&&e.jsxs(k,{variant:"outline",className:"bg-green-100 text-green-700",children:["v",n.version]})]})}),e.jsx(o,{className:"space-y-3",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsx("span",{children:"Status:"}),e.jsx(k,{variant:"outline",children:n.status})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsx("span",{children:"Fertigstellung:"}),e.jsxs("span",{className:"font-semibold",children:[n.completionPercentage,"%"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>g(n.id),children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Bearbeiten"]}),e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"PDF"]})]})]}):e.jsxs(i,{size:"sm",className:"w-full gap-2",onClick:()=>p.mutate(t.id),disabled:p.isPending,children:[e.jsx(V,{className:"h-4 w-4"}),"Erstellen"]})})]},t.id)})})]},s))]}),e.jsxs(l,{className:"border-2 border-blue-200 bg-blue-50",children:[e.jsxs(r,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5 text-blue-600"}),"Gesamte PRODUKTAKTE (Device Master File)"]}),e.jsx(_,{children:"Automatische Zusammenstellung aller eingereichten Dokumente mit Versionsübersicht"})]}),e.jsx(o,{children:e.jsxs(i,{className:"gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Alle Dokumente als ZIP exportieren"]})})]})]})}export{W as default};
